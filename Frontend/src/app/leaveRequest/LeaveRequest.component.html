<div class="container mt-4">
  <h2>Leave Requests</h2>

  <div class="mb-3">
    <label for="employeeSelect" class="form-label">Select Employee:</label>
    <select id="employeeSelect" class="form-select" [(ngModel)]="selectedEmployee" (ngModelChange)="onEmployeeSelect()">
      <option [ngValue]="null">Select an employee</option>
      <option *ngFor="let employee of employees" [ngValue]="employee">{{ employee.username }}</option>
    </select>
  </div>
<!-- 
  <div *ngIf="selectedEmployee">
    <p>Total Vacation Days  : {{ vacationDays !== null ? vacationDays : 'Loading...' }}</p>  -->
    <!-- <button class="btn btn-primary" (click)="updateVacationDays()">more details</button> -->
    <div *ngIf="selectedEmployee">
      <p>
        Vacation Days Available: {{ vacationDays !== null ? vacationDays : 'Loading...' }}
        <button class="btn btn-sm btn-info ms-2" (click)="toggleDetailedBalance()">Show More</button>
      </p>
  
      <!-- Modal for detailed balance -->
      <div class="modal" [ngClass]="{'d-block': showDetailedBalance}" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Detailed Leave Balance</h5>
              <button type="button" class="close" (click)="toggleDetailedBalance()" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p>Vacation Days: {{ vacationDays !== null ? vacationDays : 'Loading...' }}</p>
              <p>Sick Days: {{ sickDays !== null ? sickDays : 'Loading...' }}</p>
              <p>Personal Days: {{ personalDays !== null ? personalDays : 'Loading...' }}</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" (click)="toggleDetailedBalance()">Close</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-backdrop fade show" *ngIf="showDetailedBalance"></div>
  
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Reason</th>
          <th>Status</th>
          <th>Approver Comments</th>
          <th>Leave Type</th>
          <th>Duration (Days)</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let request of leaveRequests">
          <td>{{ request.startDate | date }}</td>
          <td>{{ request.endDate | date }}</td>
          <td>{{ request.reason }}</td>
          <td>{{ request.status }}</td>
          <td>{{ request.approverComments }}</td>
          <td>{{ request.leaveType }}</td>
          <td>{{ request.durationDays }}</td>
          <td>
            <button class="btn btn-sm btn-primary" (click)="approveLeaveRequest(request.id)" [disabled]="request.status !== 'PENDING'">Approve</button>      
            <button class="btn btn-sm btn-danger" (click)="rejectLeaveRequest(request.id)" [disabled]="request.status !== 'PENDING'">Reject</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="alert alert-info" *ngIf="!selectedEmployee">
    Select an employee to view leave requests.
  </div>

  <!-- <button class="btn btn-primary" (click)="initializeLeaveRequest()">Initialize Leave Request</button> -->
</div>